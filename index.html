<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prov√£o Paulista - Simulador de Notas</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: Arial, sans-serif; }
        body { background: #f9f9f9; text-align: center; padding: 10px; }
        .container { max-width: 400px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h1 { font-size: 20px; margin-bottom: 15px; }
        label { font-weight: bold; display: block; margin: 10px 0 5px; text-align: left; }
        select, input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        button { width: 100%; padding: 10px; margin-top: 15px; background: #007BFF; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #results { margin-top: 20px; text-align: left; }
        .person { background: #f1f1f1; padding: 10px; border-radius: 5px; margin-top: 10px; }
        .popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: none; z-index: 1000; max-width: 90%; }
        .popup button { background: red; margin-top: 10px; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 999; }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <div class="popup" id="popup">
        <h2>‚ö†Ô∏è Observa√ß√£o</h2>
        <p>As notas exibidas s√£o baseadas nos dados dispon√≠veis e podem n√£o representar o corte exato para aprova√ß√£o.</p>
        <button onclick="fecharPopup()">Fechar</button>
    </div>
    
    <div class="container">
        <h1>üìö Simulador de Notas - Prov√£o Paulista</h1>
        <label for="categorySelect">1Ô∏è‚É£ Escolha uma Categoria:</label>
        <select id="categorySelect">
            <option value="">Selecione uma categoria</option>
        </select>

        <label for="courseInput">2Ô∏è‚É£ Digite ou escolha o Curso:</label>
        <input type="text" id="courseInput" list="coursesList" placeholder="Digite o nome do curso" disabled>
        <datalist id="coursesList"></datalist>

        <label for="institutionInput">(Opcional) Filtrar por Institui√ß√£o:</label>
        <input type="text" id="institutionInput" list="institutionsList" placeholder="Digite o nome da Institui√ß√£o">
        <datalist id="institutionsList"></datalist>

        <button id="searchButton" disabled>üîç Buscar</button>
        <div id="results"><h2>Resultados:</h2><div id="peopleList"></div></div>
    </div>
    
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("popup").style.display = "block";
            document.getElementById("overlay").style.display = "block";
        });
        function fecharPopup() {
            document.getElementById("popup").style.display = "none";
            document.getElementById("overlay").style.display = "none";
        }
    </script>
</body>
</html>


    <script>
        const categorySelect = document.getElementById('categorySelect');
        const institutionInput = document.getElementById('institutionInput');
        const courseInput = document.getElementById('courseInput');
        const searchButton = document.getElementById('searchButton');
        const resultsDiv = document.getElementById('peopleList');
        const coursesList = document.getElementById('coursesList');
        const institutionsList = document.getElementById('institutionsList');
        let allCourses = {};
        let allInstitutions = {};
        let currentCategory = null;

        fetch('https://provao.onrender.com/categories')
            .then(response => response.json())
            .then(categories => {
                categories.forEach(category => {
                    let option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            });

        categorySelect.addEventListener('change', () => {
            currentCategory = categorySelect.value;
            courseInput.disabled = false;
            searchButton.disabled = false;
            courseInput.value = '';
            institutionInput.value = '';
            coursesList.innerHTML = '';
            institutionsList.innerHTML = '';

            if (currentCategory) {
                fetch(`https://provao.onrender.com/courses?category=${currentCategory}`)
                    .then(response => response.json())
                    .then(courses => {
                        allCourses[currentCategory] = courses;
                    });
                fetch(`https://provao.onrender.com/institutions?category=${currentCategory}`)
                    .then(response => response.json())
                    .then(institutions => {
                        allInstitutions[currentCategory] = institutions;
                    });
            } else {
                courseInput.disabled = true;
                searchButton.disabled = true;
            }
        });

        institutionInput.addEventListener('input', () => {
            const currentInput = institutionInput.value;
            institutionsList.innerHTML = '';

            if (currentInput.length >= 3 && currentCategory) {
                const categoryInstitutions = allInstitutions[currentCategory] || [];
                const filteredInstitutions = categoryInstitutions.filter(institution =>
                    institution.toLowerCase().startsWith(currentInput.toLowerCase())
                );

                filteredInstitutions.forEach(institution => {
                    let option = document.createElement('option');
                    option.value = institution;
                    institutionsList.appendChild(option);
                });
            }
        });

        courseInput.addEventListener('input', () => {
            const currentInput = courseInput.value;
            coursesList.innerHTML = '';

            if (currentInput.length >= 3 && currentCategory) {
                const categoryCourses = allCourses[currentCategory] || [];
                const filteredCourses = categoryCourses.filter(course =>
                    course.toLowerCase().startsWith(currentInput.toLowerCase())
                );

                filteredCourses.forEach(course => {
                    let option = document.createElement('option');
                    option.value = course;
                    coursesList.appendChild(option);
                });
            }
        });

        searchButton.addEventListener('click', () => {
            const selectedCourse = courseInput.value;
            const selectedInstitution = institutionInput.value;
            if (!selectedCourse) {
                alert("Por favor, digite ou selecione um curso.");
                return;
            }

            if (!currentCategory) {
                alert("Por favor, selecione uma categoria.");
                return;
            }

            const requestBody = { course: selectedCourse, category: currentCategory };
            if (selectedInstitution) {
                requestBody.institution = selectedInstitution;
            }

            fetch('https://provao.onrender.com/filter_course', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            })
            .then(response => response.json())
            .then(people => {
                resultsDiv.innerHTML = people.length > 0 ? people.map(person => `
                    <div class="person">
                        <p><strong>Institui√ß√£o:</strong> ${person.Institui√ß√£o}</p>
                        <p><strong>Curso:</strong> ${person.Curso}</p>
                        <p><strong>Nota:</strong> ${person.Nota}</p>
                        <p><strong>Grupo:</strong> ${person.Grupo}</p>
                    </div>`).join('') : '<p>Nenhum aluno encontrado.</p>';
            });
        });
    </script>

</body>
</html>
